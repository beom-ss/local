proc reg data-sam1;
model y=x;
run;
data sam;
input x y;
cards;
186 175
180 168
160 154
186 166
163 162
172 152
192 179
170 163
174 172
191 170
182 170
178 147
181 165
168 162
162 154
188 166
168 167
183 174
188 173
166 164
180 163
176 163
185 171
169 161
182 167
162 160
169 165
176 167
180 175
157 157
170 172
186 181
180 166
188 181
153 148
179 169
175 170
165 157
156 162
185 174
172 168
166 162
179 159
181 155
176 171
170 159
165 164
183 175
162 156
192 180
185 167
163 157
185 167
170 157
176 168
176 167
160 145
167 156
157 153
180 162
172 156
184 174
185 160
165 152
181 175
170 169
161 149
188 176
181 165
156 143
161 158
152 141
179 160
170 149
170 160
165 148
165 154
169 171
171 165
192 175
176 161
168 162
169 162
184 176
171 160
161 158
185 175
184 174
179 168
184 177
175 158
173 161
164 146
181 168
187 178
181 170
;
run;

proc corr data=sam cov;
run;

/*(a) 남편과 아내의 키 사이의 공분산 : 69.4129386 
(c) 남편과 아내의 키 사이의 상관계수 :  0.76339 */

proc sql;
create table sam1 as select x*0.01, y*0.01 from sam;
quit;

proc corr data=sam1 cov;
run;

/*(b) 키가 센티미터가 아닌 미터로 측정되었을 때의 공분산 : 0.0069412939
(d) 키가 센티미터가 아닌 미터로 측정되었을 때의 상관계수 :  0.76339*/

proc sql;
create table sam2 as select y-5, y from sam;
quit;
proc corr data=sam2 cov;
run;

/*(e) 모든 남자들이 자신보다 정확히 5cm 작은 여자와 결혼 하였을 때의 상관계수 :   1.00000*/

proc reg data=sam;
model y=x;
run;
proc reg data=sam;
model x=y;
run;

/*(f) 남편과 아내의 키에 관한 적합성을 보면 r-squre는 모두  0.5828 로 갔다.
하지만 y=x일 때의 root mse가 5.92801이 x=y의 6.46800 때보다 더 값이 작으므로
y=x로 아내의 키를 반응변수로 두는 것이 더 바람직하다.*/

proc reg data=sam;
model y=x;
run;

/*(g) b1=0.06106에 대한 표준화 t값을 11.46으로 설정했을 경우 기각역 확률이 0.001로 나타나있다. 
따라서 유의수준이 5%인 경우 11.46의 값은 t의 기각역에 속하게 되어 기울기가 0이라는 귀무가설을 기각하게 된다.*/

/*(h) 표준화 t값을 3.93으로 설정했을 경우 기각역 확률이 0.0002로 나타나 있다 .
따라서 유의수준이 5%인 경우 3.93의 값은 t의 기각역에 속하게 되어 절편항이 0이라는 귀무가설을 기각하게 된다.*/

/*(j) f에서 검정한 것을 선택하겠다. 왜냐하면 b1은 x가 증가함에 따라 y가 어떻게 변화하는지 알 수 있다. 
f번에서 b1dl 0이 아님을 기각했기 때문에 둘 사이에 어떠한 경향이 있음을 알 수 있다.*/


data exam;
input State$ age	HS Income Black Female	Price Sales;
cards;
AL	 27.0	41.3	2948.0	26.2	51.7	42.7	89.8
AK	22.9	66.7	4644.0	3.0	45.7	41.8	121.3
AZ	26.3	58.1	3665.0	3.0	50.8	38.5	115.2
AR	29.1	39.9	2878.0	18.3	51.5	38.8	100.3
CA	28.1	62.6	4493.0	7.0	50.8	39.7	123.0
CO	26.2	63.9	3855.0	3.0	50.7	31.1	124.8
CT	29.1	56.0	4917.0	6.0	51.5	45.5	120.0
DE	26.8	54.6	4524.0	14.3	51.3	41.3	155.0
DC	28.4	55.2	5079.0	71.1	53.5	32.6	200.4
FL	32.3	52.6	3738.0	15.3	51.8	43.8	123.6
GA	25.9	40.6	3354.0	25.9	51.4	35.8	109.9
HI	25.0	61.9	4623.0	1.0	48.0	36.7	82.1
ID	26.4	59.5	3290.0	0.3	50.1	33.6	102.4
IL	28.6	52.6	4507.0	12.8	51.5	41.4	124.8
IN	27.2	52.9	3772.0	6.9	51.3	32.2	134.6
IO	28.8	59.0	3751.0	1.2	51.4	38.5	108.5
KA	28.7	59.9	3853.0	4.8	51.0	38.9	114.0
KY	27.5	38.5	3112.0	7.2	50.9	30.1	155.8
LA	24.8	42.2	3090.0	29.8	51.4	39.3	115.9
ME	28.	54.7	3302.0	0.3	51.3	38.8	128.5
MD	27.1	52.3	4309.0	17.8	51.1	34.2	123.5
MA	29.0	58.5	4340.0	3.1	52.2	41.0	124.3
MI	26.3	52.8	4180.0	11.2	51.0	39.2	128.6
MN	26.8	57.6	3859.0	0.9	51.0	40.1	104.3
MS	25.1	41.0	2626.0	36.8	51.6	37.5	93.4
MO	29.4	48.8	3781.0	10.3	51.8	36.8	121.3
MT	27.1	59.2	3500.0	0.3	50.0	34.7	111.2
NB	28.6	59.3	3789.0	2.7	51.2	34.7	108.1
NV	27.8	65.2	4563.0	5.7	49.3	44.0	189.5
NH	28.0	57.6	3737.0	0.3	51.1	34.1	265.7
NJ	30.1	52.5	4701.0	10.8	51.6	41.7	120.7
NM	23.9	55.2	3077.0	1.9	50.7	41.7	90.0
NY	30.3	52.7	4712.0	11.9	52.2	41.7	119.0
NC	26.5	38.5	3252.0	22.2	51.0	29.4	172.4
ND	26.4	50.3	3086.0	0.4	49.5	38.9	93.8
OH	27.7	53.2	4020.0	9.1	51.5	38.1	121.6
OK	29.4	51.6	3387.0	6.7	51.3	39.8	108.4
OR	29.0	60.0	3719.0	1.3	51.0	29.0	157.0
PA	30.7	50.2	3971.0	8.0	52.0	44.7	107.3
RI	29.2	46.4	3959.0	2.7	50.9	40.2	123.9
SC	24.8	37.8	2990.0	30.5	50.9	34.3	103.6
SD	27.4	53.3	3123.0	0.3	50.3	38.5	92.7
TN	28.1	41.8	3119.0	15.8	51.6	41.6	99.8
TX	26.4	47.4	3606.0	12.5	51.0	42.0	106.4
UT	23.1	67.3	3227.0	0.6	50.6	36.6	65.5
VT	26.8	57.1	3468.0	0.2	51.1	39.5	122.6
VA	26.8	47.8	3712.0	18.5	50.6	30.2	124.3
WA	27.5	63.5	4053.0	2.1	50.3	40.3	96.7
WV	30.0	41.6	3061.0	3.9	51.6	41.6	114.5
WI	27.2	54.5	3812.0	2.9	50.9	40.2	106.4
WY	27.2	62.9	3815.0	0.8	50.0	34.4	132.2
;
run;


proc reg data=exam;
model sales= age HS Income Black Female Price;
test female=0;
run;

/* f-value는 0.04로 p-value 0.8507보다 작으므로 기각할 수 없다. */   <---------- 귀무가설은 ????

proc reg data=exam;
model sales= age HS Income Black Female Price;
test female=0, hs=0;
run;
/* f-value는 0.02로 p-value 0.9787보다 작으므로 기각할 수 없다.*/    <---------- 귀무가설은 ????

proc reg data=exam;
model sales= age HS Income Black Female Price/i;
data tvalue;
alpha=0.05;
df=(50-6-1);
t=tinv(1-alpha/2,df);
run;

/* income에 대한 신뢰구간 95%는 0.01895 -2.0166921992~ 0.01895+2.0166921992이다.

proc reg data=exam;
model sales= age HS  Black Female Price;
run;

/*(d) r-squre 값만 구하면 되므로, r-squre값은 0.2678*/

proc reg data=exam;
model sales= age income Price;
run;

/*r-squre값은  0.3032*/

proc reg data=exam;
model sales= income;
run;

 /*r-squre값은 0.1063*/